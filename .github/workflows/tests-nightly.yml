name: Nightly Tests

on:
  # Nightly nightly tests at 2 AM UTC
  schedule:
    - cron: '0 2 * * *'

  # Manual trigger
  workflow_dispatch:
    inputs:
      reason:
        description: 'Reason for running tests manually'
        required: false
        default: 'Manual nightly test run'

permissions:
  actions: write
  contents: write

jobs:
  run-nightly-tests:
    uses: ./.github/workflows/core-test-runner.yml
    with:
      test_type: 'nightly'
      test_command: 'npm run test:nightly'
      retention_days: '3'
      test_description: 'nightly Tests'
      cleanup_before_run: 'true'
      timeout_minutes: 120
      test_tags: '@nightly'
